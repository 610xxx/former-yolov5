# YOLOv5 ğŸš€ by Ultralytics, GPL-3.0 license  
# TPH-yolov5 æ— äººæœºè§†é‡æ£€æµ‹ï¼Œå®šä½èƒ½åŠ›è¾ƒå¥½ï¼Œ5xè®¡ç®—é‡ä¸º250Glops   å‚è€ƒï¼š https://github.com/cv516Buaa/tph-yolov5/tree/main/models
# Parameters
nc: 80  # number of classes   ğŸš©
depth_multiple: 0.33  # model depth multiple     1.0
width_multiple: 0.50 # layer channel multiple    1.0    åˆå§‹24GFLOPS"box0.1 obj0.01 cls0.01 p0.45  r0.08 map0.04  0.01"c3træ•ˆæœä¸€èˆ¬ï¼Œå¯èƒ½ä¸æ•°æ®å·²ç»4kæœ‰å…³ã€‚"
anchors: 4      # ï¼ˆå¾…æµ‹ï¼‰ğŸ’Š 6ç»„  4x4å°±æ˜¯16ç»„
  # - [10,13, 16,30, 33,23]  # P3/8
  # - [30,61, 62,45, 59,119]  # P4/16
  # - [116,90, 156,198, 373,326]  # P5/32


#YOLOv5 v6.0 backbone  ï¼ˆs6ï¼‰
backbone:
  # [from, number, module, args]
  [[-1, 1, Conv, [64, 6, 2, 2]],  # 0-P1/2
   [-1, 1, Conv, [128, 3, 2]],  # 1-P2/4
   [-1, 3, C3, [128]],
   [-1, 1, Conv, [256, 3, 2]],  # 3-P3/8
   [-1, 6, C3, [256]],
   [-1, 1, Conv, [512, 3, 2]],  # 5-P4/16
   [-1, 9, C3, [512]],
   [-1, 1, Conv, [1024, 3, 2]],  # 7-P5/32
   [-1, 3, C3TR, [1024]],  #  --C3æ¨¡å—æ›¿æ¢ğŸ’£
   [-1, 3, CBAM, [1024]],  #æ³¨æ„åŠ›backå¯¹æ¯”head  
   [-1, 1, SPPF, [1024, 5]],  # 9
  ]

# YOLOv5 v6.0 head
head:
  [[-1, 1, Conv, [512, 1, 1]],
   [-1, 1, nn.Upsample, [None, 2, 'nearest']],
   [[-1, 6], 1, BiFPN_Concat2, [1]],  # cat backbone P4  ğŸ’£
   [-1, 3, C3, [512, False]],  # 13

   [-1, 1, Conv, [256, 1, 1]],
   [-1, 1, nn.Upsample, [None, 2, 'nearest']],
   [[-1, 4], 1, BiFPN_Concat2, [1]],  # cat backbone P3  ğŸ’£
   [-1, 3, C3, [256, False]],  # 17 (P3/8-small)      //18
   
   [ -1, 1, Conv, [ 128, 1, 1 ] ],
   [ -1, 1, nn.Upsample, [ None, 2, 'nearest' ] ],
   [ [ -1, 2 ], 1, BiFPN_Concat2, [1] ],  # cat backbone P2  ğŸ’£
   [-1, 1, SPP, [128, [5, 9, 13]]],
   [ -1, 3, C3, [ 128, False ] ],  #  (P2/4-xsmall)    âœ’ï¸  //23
   #[-1, 1, CBAM, [128]],           # 23                ğŸ’£

   [ -1, 1, Conv, [ 128, 3, 2 ] ],
   [[-1, 19, 4], 1, BiFPN_Concat3, [1] ],  # cat head P3  ğŸ’£
   [-1, 1, SPP, [256, [5, 9, 13]]],
   [ -1, 3, C3, [ 256, False ] ],  # (P3/8-small)   âœ’ï¸  27
   #[-1, 1, CBAM, [256]],          # 28        ğŸ’£
 
   [-1, 1, Conv, [256, 3, 2]],
   [[-1, 15, 6], 1, BiFPN_Concat3, [1]],  # cat head P4   ğŸ’£
   [-1, 1, SPP, [512, [3, 7, 11]]],
   [-1, 3, C3, [512, False]],  #  (P4/16-medium)   âœ’ï¸    31
   #[-1, 1, CBAM, [512]],       # 33              ğŸ’£

   [-1, 1, Conv, [512, 3, 2]],
   [[-1, 11], 1, BiFPN_Concat2, [1]],  # cat head P5    ConcatğŸ’£
   [-1, 1, SPP, [1024, [3, 5, 7]]],
   [-1, 3, C3TR, [1024, False]],  #  (P5/32-large)  å¢å¤§GFOLTS//æ›´æ¢c3str   âœ’ï¸ //35
   #[-1, 1, CBAM, [1024]],        # 38     ğŸ’£

   [[23, 27, 31, 35], 1, Detect, [nc,anchors]],  # Detect(P2, P3, P4, P5)  âœ’ï¸ 
  ]

 # 'Model' object has no attribute 'stride'


# """
# #v5l+tph-plus.yamlğŸ’£ğŸ’£ğŸ’£ğŸ’£ğŸ’£ğŸ’£ğŸ’£ğŸ’£ğŸ’£å‚è€ƒ  https://github.com/cv516Buaa/tph-yolov5/blob/main/models/yolov5l-tph-plus.yaml

# nc: 3  # number of classes
# depth_multiple: 0.33  # model depth multiple   1.0
# width_multiple: 0.50  # layer channel multiple   1.0
# anchors: 3
#   # - [10,13, 16,30, 33,23]  # P3/8
#   # - [30,61, 62,45, 59,119]  # P4/16
#   # - [116,90, 156,198, 373,326]  # P5/32

# # YOLOv5 v6.0 backbone
# backbone:
#   # [from, number, module, args]
#    [[-1, 1, Conv, [64, 6, 2, 2]],  # 0-P1/2
#    [-1, 1, Conv, [128, 3, 2]],  # 1-P2/4
#    [-1, 3, C3, [128]],
#    [-1, 1, Conv, [256, 3, 2]],  # 3-P3/8
#    [-1, 6, C3, [256]],
#    [-1, 1, Conv, [512, 3, 2]],  # 5-P4/16
#    [-1, 9, C3, [512]],
#    [-1, 1, Conv, [1024, 3, 2]],  # 7-P5/32
#    [-1, 3, C3, [1024]],
#    [-1, 1, SPPF, [1024, 5]],  # 9
#   ]

# # YOLOv5 v6.0 head
# head:
#   [[-1, 1, Conv, [512, 1, 1]],
#    [-1, 1, nn.Upsample, [None, 2, 'nearest']],
#    [[-1, 6], 1, Concat, [1]],  # cat backbone P4
#    [-1, 3, C3, [512, False]],  # 13

#    [-1, 1, Conv, [256, 1, 1]],
#    [-1, 1, nn.Upsample, [None, 2, 'nearest']],
#    [[-1, 4], 1, Concat, [1]],  # cat backbone P3
#    [-1, 3, C3, [256, False]],  # 17 (P3/8-small)

#    [-1, 1, Conv, [256, 3, 2]],
#    [[-1, 14], 1, Concat, [1]],  # cat head P4
#    [-1, 3, C3, [512, False]],  # 20 (P4/16-medium)

#    [-1, 1, Conv, [512, 3, 2]],
#    [[-1, 10], 1, Concat, [1]],  # cat head P5
#    [-1, 1, C3STR, [1024, False]],  # 23 (P5/32-large)  æ·»åŠ ä½ç½®   â˜¸ï¸

#    [[2ï¼Œ17, 20, 23], 1, CLLADetect, [nc, anchors]],  # Detect(P3, P4, P5)  ç”¨CLLAæ¨ç†  ä¸è¿›è¡Œè®¡ç®—fplos---AttributeError:'Model' object has no attribute 'stride'
#   ]
#     c3, c3 ,c3, c3str cocnat(ä¸¤ä¸ªc3/6/4,ä¸¤ä¸ªconv/14/10))
# """






# ğŸš©ğŸš©ğŸš©ğŸš©ğŸš©ğŸš©ğŸš©ğŸš©ğŸš©ğŸš©ğŸš©ğŸš©
# """
# #5l+xs-tph.yaml   å‚è€ƒï¼šhttps://github.com/cv516Buaa/tph-yolov5/blob/main/models/yolov5l-xs-tph.yaml

# nc: 80  # number of classes
# depth_multiple: 1.0  # model depth multiple
# width_multiple: 1.0  # layer channel multiple
# anchors: 4
#   # - [10,13, 16,30, 33,23]  # P3/8
#   # - [30,61, 62,45, 59,119]  # P4/16
#   # - [116,90, 156,198, 373,326]  # P5/32

# # YOLOv5 v6.0 backbone
# backbone:
#   # [from, number, module, args]
#   [[-1, 1, Conv, [64, 6, 2, 2]],  # 0-P1/2
#    [-1, 1, Conv, [128, 3, 2]],  # 1-P2/4
#    [-1, 3, C3, [128]],
#    [-1, 1, Conv, [256, 3, 2]],  # 3-P3/8
#    [-1, 6, C3, [256]],
#    [-1, 1, Conv, [512, 3, 2]],  # 5-P4/16
#    [-1, 9, C3, [512]],
#    [-1, 1, Conv, [1024, 3, 2]],  # 7-P5/32
#    [-1, 3, C3, [1024]],
#    [-1, 1, SPPF, [1024, 5]],  # 9
#   ]

# # YOLOv5 v6.0 head
# head:
#   [[-1, 1, Conv, [512, 1, 1]],   #
#    [-1, 1, nn.Upsample, [None, 2, 'nearest']],
#    [[-1, 6], 1, Concat, [1]],  # cat backbone P4
#    [-1, 3, C3, [512, False]],  # 13

#    [-1, 1, Conv, [256, 1, 1]],
#    [-1, 1, nn.Upsample, [None, 2, 'nearest']],
#    [[-1, 4], 1, Concat, [1]],  # cat backbone P3
#    [-1, 3, C3, [256, False]],  # 17 (P3/8-small)

#    [ -1, 1, Conv, [ 128, 1, 1 ] ],
#    [ -1, 1, nn.Upsample, [ None, 2, 'nearest' ] ],
#    [ [ -1, 2 ], 1, Concat, [ 1 ] ],  # cat backbone P2
#    [ -1, 2, C3STR, [ 128, False ] ],  # 21 (P2/4-xsmall)   â˜¸ï¸c3

#    [ -1, 1, Conv, [ 128, 3, 2 ] ],
#    [ [ -1, 18, 4], 1, Concat, [ 1 ] ],  # cat head P3
#    [ -1, 2, C3STR, [ 256, False ] ],  # 24 (P3/8-small)  â˜¸ï¸  c3

#    [-1, 1, Conv, [256, 3, 2]],
#    [[-1, 14, 6], 1, Concat, [1]],  # cat head P4
#    [-1, 2, C3STR, [512, False]],  # 27 (P4/16-medium)   â˜¸ï¸ c3

#    [-1, 1, Conv, [512, 3, 2]],
#    [[-1, 10], 1, Concat, [1]],  # cat head P5
#    [-1, 2, C3STR, [1024, False]],  # 30 (P5/32-large)   â˜¸ï¸ c3strè®¡ç®—é‡å¤§

#    [[21, 24, 27, 30], 1, Detect, [nc, anchors]],  # Detect(P3, P4, P5)ğŸ’Š
#    ] 
    #concatæ“ä½œä¸€åŠc3ä¸€åŠconv                AttributeError: module 'torch.functional' has no attribute 'pad'
 
